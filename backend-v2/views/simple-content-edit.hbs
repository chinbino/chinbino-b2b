<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø­ØªÙˆØ§ - {{content.title.fa}}</title>
    <style>
        body {
            font-family: Tahoma, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            direction: rtl;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: Tahoma, sans-serif;
            font-size: 14px;
            box-sizing: border-box;
        }
        textarea {
            resize: vertical;
            min-height: 80px;
        }
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        .form-col {
            flex: 1;
        }
        .checkbox-group {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .checkbox-item input {
            width: auto;
        }
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }
        .btn-primary {
            background-color: #007bff;
            color: white;
        }
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        .btn-success {
            background-color: #28a745;
            color: white;
        }
        .btn-danger {
            background-color: #dc3545;
            color: white;
        }
        .btn:hover {
            opacity: 0.9;
        }
        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            flex-wrap: wrap;
        }
        .required::after {
            content: " *";
            color: #dc3545;
        }
        .help-text {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        .error-message {
            background-color: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        .success-message {
            background-color: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        .content-info {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-size: 14px;
        }
        .content-info strong {
            color: #495057;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø­ØªÙˆØ§: {{content.title.fa}}</h1>

        {{#if error}}
        <div class="error-message">
            âŒ Ø®Ø·Ø§: {{error}}
        </div>
        {{/if}}

        {{#if success}}
        <div class="content-info">
            <strong>Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø­ØªÙˆØ§:</strong> 
            ID: {{content.id}} | 
            Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯Ù‡ Ø¯Ø±: {{formatDate content.createdAt}} | 
            Ø¢Ø®Ø±ÛŒÙ† ÙˆÛŒØ±Ø§ÛŒØ´: {{formatDate content.updatedAt}}
        </div>

        <form method="POST" action="/admin/contents/{{content.id}}/edit">
            <div class="form-row">
                <div class="form-col">
                    <div class="form-group">
                        <label for="type" class="required">Ù†ÙˆØ¹ Ù…Ø­ØªÙˆØ§:</label>
                        <select name="type" id="type" required>
                            {{#each contentTypes}}
                            <option value="{{this}}" {{#eq this ../content.type}}selected{{/eq}}>{{this}}</option>
                            {{/each}}
                        </select>
                    </div>
                </div>
                
                <div class="form-col">
                    <div class="form-group">
                        <label for="status" class="required">ÙˆØ¶Ø¹ÛŒØª:</label>
                        <select name="status" id="status" required>
                            {{#each statusTypes}}
                            <option value="{{this}}" {{#eq this ../content.status}}selected{{/eq}}>{{this}}</option>
                            {{/each}}
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="slug" class="required">Slug:</label>
                <input type="text" name="slug" id="slug" required 
                       value="{{content.slug}}"
                       pattern="[a-zA-Z0-9-]+" 
                       title="ÙÙ‚Ø· Ø­Ø±ÙˆÙ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒØŒ Ø§Ø¹Ø¯Ø§Ø¯ Ùˆ Ø®Ø· ØªÛŒØ±Ù‡ Ù…Ø¬Ø§Ø² Ø§Ø³Øª">
                <div class="help-text">ÙÙ‚Ø· Ø­Ø±ÙˆÙ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒØŒ Ø§Ø¹Ø¯Ø§Ø¯ Ùˆ Ø®Ø· ØªÛŒØ±Ù‡ Ù…Ø¬Ø§Ø² Ø§Ø³Øª</div>
            </div>

            <div class="form-group">
                <label for="title_fa" class="required">Ø¹Ù†ÙˆØ§Ù† ÙØ§Ø±Ø³ÛŒ:</label>
                <input type="text" name="title_fa" id="title_fa" required 
                       value="{{content.title.fa}}"
                       placeholder="Ø¹Ù†ÙˆØ§Ù† Ù…Ø­ØªÙˆØ§ Ø¨Ù‡ ÙØ§Ø±Ø³ÛŒ">
            </div>

            <div class="form-group">
                <label for="title_en">Ø¹Ù†ÙˆØ§Ù† Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
                <input type="text" name="title_en" id="title_en" 
                       value="{{content.title.en}}"
                       placeholder="English title">
            </div>

            <div class="form-group">
                <label for="excerpt_fa">Ú†Ú©ÛŒØ¯Ù‡ ÙØ§Ø±Ø³ÛŒ:</label>
                <textarea name="excerpt_fa" id="excerpt_fa" 
                          placeholder="Ø®Ù„Ø§ØµÙ‡ Ú©ÙˆØªØ§Ù‡ Ø§Ø² Ù…Ø­ØªÙˆØ§ Ø¨Ù‡ ÙØ§Ø±Ø³ÛŒ">{{content.excerpt.fa}}</textarea>
            </div>

            <div class="form-group">
                <label for="excerpt_en">Ú†Ú©ÛŒØ¯Ù‡ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
                <textarea name="excerpt_en" id="excerpt_en" 
                          placeholder="English excerpt">{{content.excerpt.en}}</textarea>
            </div>

            <div class="form-group">
                <label>Ø²Ø¨Ø§Ù†â€ŒÙ‡Ø§:</label>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" name="locales" value="fa" id="locale_fa">
                        <label for="locale_fa">ÙØ§Ø±Ø³ÛŒ</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" name="locales" value="en" id="locale_en">
                        <label for="locale_en">Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ</label>
                    </div>
                </div>
            </div>

            <div class="form-row">
                <div class="form-col">
                    <div class="form-group">
                        <label for="meta_title_fa">Ø¹Ù†ÙˆØ§Ù† Ù…ØªØ§ (ÙØ§Ø±Ø³ÛŒ):</label>
                        <input type="text" name="meta_title_fa" id="meta_title_fa" 
                               value="{{content.seo.metaTitle.fa}}"
                               placeholder="Ø¹Ù†ÙˆØ§Ù† Ø¨Ø±Ø§ÛŒ SEO">
                    </div>
                </div>
                <div class="form-col">
                    <div class="form-group">
                        <label for="meta_title_en">Ø¹Ù†ÙˆØ§Ù† Ù…ØªØ§ (Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ):</label>
                        <input type="text" name="meta_title_en" id="meta_title_en" 
                               value="{{content.seo.metaTitle.en}}"
                               placeholder="Meta title for SEO">
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="meta_description_fa">ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…ØªØ§ (ÙØ§Ø±Ø³ÛŒ):</label>
                <textarea name="meta_description_fa" id="meta_description_fa" 
                          placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª Ø¨Ø±Ø§ÛŒ SEO">{{content.seo.metaDescription.fa}}</textarea>
            </div>

            <div class="form-group">
                <label for="meta_description_en">ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…ØªØ§ (Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ):</label>
                <textarea name="meta_description_en" id="meta_description_en" 
                          placeholder="Meta description for SEO">{{content.seo.metaDescription.en}}</textarea>
            </div>

            <div class="form-group">
                <label for="blocks">Ø¨Ù„ÙˆÚ©â€ŒÙ‡Ø§ (JSON):</label>
                <textarea name="blocks" id="blocks" rows="12" 
                          placeholder='[{"type": "heading", "data": {"text": {"fa": "Ø¹Ù†ÙˆØ§Ù† Ø§ØµÙ„ÛŒ"}, "level": 1}}, {"type": "paragraph", "data": {"text": {"fa": "Ù…ØªÙ† Ù¾Ø§Ø±Ø§Ú¯Ø±Ø§Ù..."}}}]'></textarea>
                <div class="help-text">
                    Ø³Ø§Ø®ØªØ§Ø± JSON Ø¨Ù„ÙˆÚ©â€ŒÙ‡Ø§. Ø¨Ø±Ø§ÛŒ ØªØ³Øª Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø²: 
                    <code>[{"type": "heading", "data": {"text": {"fa": "Ø¹Ù†ÙˆØ§Ù† ØªØ³Øª"}, "level": 2}}]</code>
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ ØªØºÛŒÛŒØ±Ø§Øª</button>
                <a href="/admin/contents/{{content.id}}/preview" class="btn btn-success">ğŸ‘ï¸ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´</a>
                <a href="/admin/contents/{{content.id}}/json" class="btn btn-secondary">ğŸ” JSON</a>
                <a href="/admin/contents" class="btn btn-secondary">â†©ï¸ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù„ÛŒØ³Øª</a>
            </div>
        </form>
        {{/if}}
    </div>

    <script>
        // ÙˆÙ‚ØªÛŒ ØµÙØ­Ù‡ Ù„ÙˆØ¯ Ø´Ø¯
        document.addEventListener('DOMContentLoaded', function() {
            // ØªÙ†Ø¸ÛŒÙ… checkboxÙ‡Ø§ÛŒ Ø²Ø¨Ø§Ù†â€ŒÙ‡Ø§
            const contentLocales = '{{content.locales}}'; // Ø§ÛŒÙ† Ø¨Ù‡ ØµÙˆØ±Øª Ø¢Ø±Ø§ÛŒÙ‡ Ù†Ù…ÛŒâ€ŒØ¢ÛŒØ¯ØŒ Ø¨Ø§ÛŒØ¯ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒÙ…
            const locales = contentLocales.split(',');
            
            if (locales.includes('fa') || contentLocales.includes('fa')) {
                document.getElementById('locale_fa').checked = true;
            }
            if (locales.includes('en') || contentLocales.includes('en')) {
                document.getElementById('locale_en').checked = true;
            }
            
            // ØªÙ†Ø¸ÛŒÙ… Ù…Ø­ØªÙˆØ§ÛŒ JSON Ø¨Ù„ÙˆÚ©â€ŒÙ‡Ø§
            const blocksTextarea = document.getElementById('blocks');
            // Ú†ÙˆÙ† Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒÙ… Ø§Ø² helper json Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒÙ…ØŒ Ø¨Ø§ÛŒØ¯ Ø±Ø§Ù‡ Ø¯ÛŒÚ¯Ø±ÛŒ Ù¾ÛŒØ¯Ø§ Ú©Ù†ÛŒÙ…
            // ÙØ¹Ù„Ø§Ù‹ Ø®Ø§Ù„ÛŒ Ù…ÛŒâ€ŒÚ¯Ø°Ø§Ø±ÛŒÙ…
            
            // Ú©Ù…Ú© Ø¨Ù‡ ÙØ±Ù…Øª JSON
            if (blocksTextarea) {
                blocksTextarea.addEventListener('blur', function() {
                    try {
                        const parsed = JSON.parse(this.value);
                        this.value = JSON.stringify(parsed, null, 2);
                    } catch (e) {
                        // Ø§Ú¯Ø± JSON Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³ØªØŒ Ú©Ø§Ø±ÛŒ Ù†Ú©Ù†
                    }
                });
            }
        });
    </script>
</body>
</html>
